angular.module("myApp",["ngRoute"]).config(["$routeProvider","$httpProvider",function(o,t){o.when("/",{templateUrl:"app/view/home.html",controller:"HomeController",controllerAs:"vm"}).when("/login",{templateUrl:"app/view/login.html",controller:"LoginController",controllerAs:"vm"}).when("/addbook",{templateUrl:"app/view/bookAdd.html",controller:"BookAddController"}).otherwise({redirectTo:"/"}),t.interceptors.push("authInterceptor")}]),(()=>{function o(o,t,e){var r=this;r.book={title:"",author:"",price:"",stock:"",categoryId:""},r.error="",r.category=[],o.get("http://localhost:5007/api/Categorys/GetAllCategory").then(o=>{r.category=o.data}),r.AddBook=function(){r.addBookForm&&r.addBookForm.$invalid?angular.forEach(r.addBookForm,function(o,t){"$"!==t[0]&&o.$setTouched&&o.$setTouched()}):t.addBook(r.book).then(()=>{e.path("/")}).catch(o=>console.log(o))}}angular.module("myApp").controller("BookAddController",o),o.$inject=["$http","bookService","$location"]})(),(()=>{function o(o,t,e,r){e.books=[],r.getBooks().then(function(o){e.books=o}),e.deleteBook=function(o){confirm("Do you Want to delete?")&&r.deleteBook(o).then(function(o){e.books=o})},e.isLoggedIn=function(){return o.isAuthenticated()}}angular.module("myApp").controller("HomeController",o),o.$inject=["authService","$rootScope","$scope","bookService"]})(),(()=>{function o(o,t){var e=this;e.user={userName:"",password:""},e.error="",e.login=function(){e.loginForm&&e.loginForm.$invalid?angular.forEach(e.loginForm,function(o,t){"$"!==t[0]&&o.$setTouched&&o.$setTouched()}):t.login(e.user).then(function(){o.path("/"),e.error=""}).catch(function(o){console.error(o),e.error=o})}}angular.module("myApp").controller("LoginController",o),o.$inject=["$location","authService"]})(),angular.module("myApp").service("authService",["$http","$window","$rootScope",function(t,e,o){this.login=function(o){return t.post("http://localhost:5007/api/Login/LoginUser",o).then(o=>(o.data&&e.localStorage.setItem("accessToken",o.data.accessToken),o.data)).catch(o=>{throw o.data.message})},this.getToken=function(){return e.localStorage.getItem("accessToken")},this.isAuthenticated=function(){return!!this.getToken()},this.logout=function(){e.localStorage.removeItem("accessToken")}}]),(()=>{function o(e){let r="http://localhost:5007/api";var n={books:[]};this.state=n,this.getBooks=function(){return e.get(r+"/Books/GellAllBooks").then(o=>(n.books=o.data,n.books)).catch(o=>{throw console.error("Error fetching books:",o),o})},this.deleteBook=function(t){return e.delete(r+"/Books/DeleteBook/"+t).then(()=>(n.books=n.books.filter(o=>o.bookId!==t),n.books)).catch(o=>{throw console.error("Error deleting book:",o),o})},this.addBook=function(o){return e.post(r+"/Books/Addbook",o).then(()=>(n.books.push(o),n.books)).catch(o=>{throw console.error("Error at Adding",o),o})}}angular.module("myApp").service("bookService",o),o.$inject=["$http"]})(),(()=>{function o(t,e,r,n){return{request:function(o){var t;return o.url.endsWith(".html")||(t=e.localStorage.getItem("accessToken"))&&(o.headers.Authorization="Bearer "+t),o},responseError:function(o){return 401===o.status&&(n.get("authService").logout(),r.path("/login")),t.reject(o)}}}angular.module("myApp").factory("authInterceptor",o),o.$inject=["$q","$window","$location","$injector"]})(),(()=>{function o(o,t){this.isLoggedIn=function(){return o.isAuthenticated()},this.logout=function(){o.logout(),t.path("/login")}}angular.module("myApp").controller("NavbarController",o),o.$inject=["authService","$location"]})();