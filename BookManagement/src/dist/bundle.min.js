angular.module("myApp",["ngRoute"]).config(["$routeProvider","$httpProvider",function(o,e){o.when("/",{templateUrl:"app/view/home.html",controller:"HomeController",controllerAs:"vm"}).when("/login",{templateUrl:"app/view/login.html",controller:"LoginController",controllerAs:"vm"}).otherwise({redirectTo:"/"}),e.interceptors.push("authInterceptor")}]),(()=>{function o(o,e,t,n){t.books=[],n.getBooks().then(function(o){t.books=o}),t.deleteBook=function(o){confirm("Do you Want to delete?")&&n.deleteBook(o).then(function(o){t.books=o})},t.isLoggedIn=function(){return o.isAuthenticated()}}angular.module("myApp").controller("HomeController",o),o.$inject=["authService","$rootScope","$scope","bookService"]})(),(()=>{function o(o,e){var t=this;t.user={userName:"",password:""},t.error="",t.login=function(){t.loginForm&&t.loginForm.$invalid?angular.forEach(t.loginForm,function(o,e){"$"!==e[0]&&o.$setTouched&&o.$setTouched()}):e.login(t.user).then(function(){o.path("/"),t.error=""}).catch(function(o){console.error(o),t.error=o})}}angular.module("myApp").controller("LoginController",o),o.$inject=["$location","authService"]})(),angular.module("myApp").service("authService",["$http","$window","$rootScope",function(e,t,o){this.login=function(o){return e.post("http://localhost:5007/api/Login/LoginUser",o).then(o=>(o.data&&t.localStorage.setItem("accessToken",o.data.accessToken),o.data)).catch(o=>{throw o.data.message})},this.getToken=function(){return t.localStorage.getItem("accessToken")},this.isAuthenticated=function(){return!!this.getToken()},this.logout=function(){t.localStorage.removeItem("accessToken")}}]),(()=>{function o(o){let t="http://localhost:5007/api";var n={books:[]};this.state=n,this.getBooks=function(){return o.get(t+"/Books/GellAllBooks").then(o=>(n.books=o.data,n.books)).catch(o=>{throw console.error("Error fetching books:",o),o})},this.deleteBook=function(e){return o.delete(t+"/Books/DeleteBook/"+e).then(()=>(n.books=n.books.filter(o=>o.bookId!==e),n.books)).catch(o=>{throw console.error("Error deleting book:",o),o})}}angular.module("myApp").service("bookService",o),o.$inject=["$http"]})(),(()=>{function o(e,t,n,r){return{request:function(o){var e;return o.url.endsWith(".html")||(e=t.localStorage.getItem("accessToken"))&&(o.headers.Authorization="Bearer "+e),o},responseError:function(o){return 401===o.status&&(r.get("authService").logout(),n.path("/login")),e.reject(o)}}}angular.module("myApp").factory("authInterceptor",o),o.$inject=["$q","$window","$location","$injector"]})(),(()=>{function o(o,e){this.isLoggedIn=function(){return o.isAuthenticated()},this.logout=function(){o.logout(),e.path("/login")}}angular.module("myApp").controller("NavbarController",o),o.$inject=["authService","$location"]})();