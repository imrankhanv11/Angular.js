function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ownKeys(o,t){var e,n=Object.keys(o);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(o),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable})),n.push.apply(n,e)),n}function _objectSpread(o){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(e),!0).forEach(function(t){_defineProperty(o,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(e)):ownKeys(Object(e)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(e,t))})}return o}function _defineProperty(t,o,e){return(o=_toPropertyKey(o))in t?Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[o]=e,t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(t,o){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===o?String:Number)(t);e=e.call(t,o||"default");if("object"!=_typeof(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}angular.module("myApp",["ngRoute"]),angular.module("myApp").constant("Endpoints",{BASE_URL:"http://localhost:5007/api",BOOK:{GET_ALL:"/Books/GellAllBooks",CREATE:"/Books/AddBook",UPDATE:"/Books/UpdateBook",DELETE:"/Books/DeleteBook/"},USER:{LOGIN:"/Login/LoginUser",REGISTER:"/Login/RegisterUser",REFRESH:"/Login/RefreshToken"},CAT:{GET_ALL:"/Categorys/GetAllCategory",DELETE:"/Categorys/DeleteCategory/",CREATE:"/Categorys/AddNewCategory",UPDATE:"/Categorys/UpdateCategory"}}),(()=>{function t(o,r,a,c,i){var u=!1,l=[];return{request:function(t){var o;return t.url.endsWith(".html")||(o=r.localStorage.getItem("accessToken"))&&(t.headers.Authorization="Bearer ".concat(o)),t},responseError:function(e){var n,t;return 401!==e.status||u?401===e.status&&u?(t=o.defer(),l.push(t),t.promise.then(function(){var t=c.get("$http"),o=r.localStorage.getItem("accessToken");return e.config.headers.Authorization="Bearer ".concat(o),t(e.config)})):o.reject(e):(u=!0,n=c.get("$http"),(t=r.localStorage.getItem("refreshToken"))?n.post("".concat(i.BASE_URL).concat(i.USER.REFRESH),{refreshToken:t}).then(function(t){var t=t.data.accessToken,o=(r.localStorage.setItem("accessToken",t),u=!1,l.forEach(function(t){return t.resolve()}),l=[],e.config);return o.headers.Authorization="Bearer ".concat(t),n(o)}).catch(function(t){return u=!1,401===t.status&&d(c,a),o.reject(t)}):(d(c,a),o.reject(e)))}};function d(t,o){t.get("authService").logout(),o.path("/login")}}angular.module("myApp").factory("authInterceptor",t),t.$inject=["$q","$window","$location","$injector","Endpoints"]})(),(()=>{function t(o,e,n){o.books=[],e.getBooks().then(function(t){o.books=t}),o.deleteBook=function(t){confirm("Do you Want to delete?")&&e.deleteBook(t).then(function(t){o.books=t})},o.editBook=function(t){n.path("addbook/"+t)}}angular.module("myApp").controller("AdminBookController",t),t.$inject=["$scope","bookService","$location"]})(),(()=>{function t(o,e){var n=this;n.Cat=[],n.isEditMode=!1,o.getCat().then(function(t){n.Cat=t}),n.deleteCat=function(t){confirm("Do you Want to delete?")&&o.deleteCat(t).then(function(t){n.Cat=t})},n.editCat=function(t){e.path("catadd/"+t)}}angular.module("myApp").component("appAdmincat",{templateUrl:"app/view/adminCatPage.html",controller:t,controllerAs:"$ctrl",bindings:{Binding:"="}}),t.$inject=["CatService","$location"]})(),(()=>{function t(t,o,e,n){var r=this;r.book={title:"",author:"",price:"",stock:"",categoryId:""},r.isEditMode=!1,r.error="",r.category=[],t.get("http://localhost:5007/api/Categorys/GetAllCategory").then(function(t){r.category=t.data}),n.id&&(r.isEditMode=!0,t=o.getBookById(Number(n.id)),r.book.title=t.title,r.book.author=t.author,r.book.price=t.price,r.book.stock=t.stock,r.book.categoryId=t.categoryId),r.AddBook=function(){r.addBookForm&&r.addBookForm.$invalid?angular.forEach(r.addBookForm,function(t,o){"$"!==o[0]&&t.$setTouched&&t.$setTouched()}):r.isEditMode?o.updateBook(_objectSpread(_objectSpread({},r.book),{},{Id:Number(n.id)})).then(function(){e.path("/")}).catch(function(t){return console.log(t)}):o.addBook(r.book).then(function(){e.path("/")}).catch(function(t){return console.log(t)})}}angular.module("myApp").controller("BookAddController",t),t.$inject=["$http","bookService","$location","$routeParams"]})(),(()=>{function t(t,o,e){var n,r=this;r.categoryName="",r.isEditMode=!1,e.id&&(r.isEditMode=!0,n=t.getCatById(Number(e.id)),r.categoryName=n.categoryName),r.formSubmit=function(){r.catFormAdd&&r.catFormAdd.$invalid?(angular.forEach(r.catFormAdd,function(t,o){"$"!==o[0]&&t.$setTouched&&t.$setTouched()}),console.log("error")):r.isEditMode?t.updateCatName({categoryName:r.categoryName,Id:Number(e.id)}).then(function(){o.path("/")}).catch(function(t){return console.log(t)}):t.addCat({categoryName:r.categoryName}).then(function(){o.path("/admincat")}).catch(function(t){return console.log(t)})}}angular.module("myApp").component("appCatadd",{templateUrl:"app/view/catAdd.html",controller:t,controllerAs:"$ctrl",bindings:{Binding:"="}}),t.$inject=["CatService","$location","$routeParams"]})(),(()=>{function t(){}angular.module("myApp").controller("HomeController",t),t.$inject=[]})(),(()=>{function t(o,t){var e=this;e.user={userName:"",password:""},e.error="",e.login=function(){e.loginForm&&e.loginForm.$invalid?angular.forEach(e.loginForm,function(t,o){"$"!==o[0]&&t.$setTouched&&t.$setTouched()}):t.login(e.user).then(function(t){o.path("/"),e.error=""}).catch(function(t){console.error(t),e.error=t})}}angular.module("myApp").controller("LoginController",t),t.$inject=["$location","authService"]})(),(()=>{function t(o,t){o.books=[],t.getBooks().then(function(t){o.books=t})}angular.module("myApp").controller("UserBookController",t),t.$inject=["$scope","bookService"]})(),angular.module("myApp").config(["$routeProvider","$httpProvider",function(t,o){t.when("/",{templateUrl:"app/view/home.html",controller:"HomeController",controllerAs:"vm"}).when("/login",{templateUrl:"app/view/login.html",controller:"LoginController",controllerAs:"vm"}).when("/adminbook",{templateUrl:"app/view/adminBookPage.html",controller:"AdminBookController",controllerAs:"vm",resolve:{auth:["authGuard",function(t){t.adminOnly()}]}}).when("/admincat",{template:"<app-admincat></app-admincat>",resolve:{auth:["authGuard",function(t){t.adminOnly()}]}}).when("/catadd",{template:"<app-catadd></app-catadd>",resolve:{auth:["authGuard",function(t){t.adminOnly()}]}}).when("/catadd/:id",{template:"<app-catadd></app-catadd>",resolve:{auth:["authGuard",function(t){t.adminOnly()}]}}).when("/addbook",{templateUrl:"app/view/bookAdd.html",controller:"BookAddController",controllerAs:"vm",resolve:{auth:["authGuard",function(t){t.adminOnly()}]}}).when("/addbook/:id",{templateUrl:"app/view/bookAdd.html",controller:"BookAddController",controllerAs:"vm",resolve:{auth:["authGuard",function(t){t.adminOnly()}]}}).when("/userbook",{templateUrl:"app/view/userBookPage.html",controller:"UserBookController",controllerAs:"vm",resolve:{auth:["authGuard",function(t){t.userOnly()}]}}).when("/unauthorized",{templateUrl:"app/view/unauthorized.html"}).otherwise({redirectTo:"/"}),o.interceptors.push("authInterceptor")}]),angular.module("myApp").factory("authGuard",["$q","$location","authService","tokenService",function(e,n,r,a){function t(t){var o;return r.isAuthenticated()?(o=(o=a.decode())?o["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]:null,!!t.includes(o)||(n.path("/unauthorized"),e.reject("Not authorized"))):(n.path("/login"),e.reject("Not authenticated"))}return{adminOnly:function(){return t(["Admin","SPAdmin"])},userOnly:function(){return t(["User"])},any:t}}]),angular.module("myApp").service("authService",["$http","$window","$rootScope","Endpoints",function(o,e,n,r){this.login=function(t){return o.post("".concat(r.BASE_URL).concat(r.USER.LOGIN),t).then(function(t){return t.data&&(e.localStorage.setItem("accessToken",t.data.accessToken),e.localStorage.setItem("refreshToken",t.data.refreshToken),n.$emit("loginSuccess")),t.data}).catch(function(t){throw t.data.message})},this.getToken=function(){return e.localStorage.getItem("accessToken")},this.isAuthenticated=function(){return!!this.getToken()},this.logout=function(){e.localStorage.removeItem("accessToken"),e.localStorage.removeItem("refreshToken"),n.$emit("logoutSuccess")}}]),(()=>{function t(n,r){var a={books:[]};this.state=a,this.getBookById=function(o){return a.books.find(function(t){return t.bookId===o})},this.getBooks=function(){return n.get("".concat(r.BASE_URL).concat(r.BOOK.GET_ALL)).then(function(t){return a.books=t.data,a.books}).catch(function(t){throw console.error("Error fetching books:",t),t})},this.updateBook=function(e){return n.put("".concat(r.BASE_URL).concat(r.BOOK.UPDATE),e).then(function(){var o,t;o=e,-1!==(t=a.books.findIndex(function(t){return t.bookId===o.Id}))&&(a.books[t]=o)}).catch(function(t){throw console.error("Error deleting book:",t),t})},this.deleteBook=function(o){return n.delete("".concat(r.BASE_URL).concat(r.BOOK.DELETE).concat(o)).then(function(){return a.books=a.books.filter(function(t){return t.bookId!==o}),a.books}).catch(function(t){throw console.error("Error deleting book:",t),t})},this.addBook=function(t){return n.post("".concat(r.BASE_URL).concat(r.BOOK.CREATE),t).then(function(){return a.books.push(t),a.books}).catch(function(t){throw console.error("Error at Adding",t),t})}}angular.module("myApp").service("bookService",t),t.$inject=["$http","Endpoints"]})(),(()=>{function t(n,r){var a={Cat:[]};this.state=a,this.getCatById=function(o){return a.Cat.find(function(t){return t.categoryId===o})},this.getCat=function(){return n.get("".concat(r.BASE_URL).concat(r.CAT.GET_ALL)).then(function(t){return a.Cat=t.data,a.Cat}).catch(function(t){throw console.error("Error fetching Cat:",t),t})},this.deleteCat=function(o){return n.delete("".concat(r.BASE_URL).concat(r.CAT.DELETE).concat(o)).then(function(){return a.Cat=a.Cat.filter(function(t){return t.categoryId!==o}),a.Cat}).catch(function(t){throw console.error("Error in Delete Cat:",t),t})},this.addCat=function(t){return n.post("".concat(r.BASE_URL).concat(r.CAT.CREATE),t).then(function(){return a.Cat.push(t),a.Cat}).catch(function(t){throw console.error("Error in Add Cat:",t),t})},this.updateCatName=function(e){return n.put("".concat(r.BASE_URL).concat(r.CAT.UPDATE),e).then(function(){var o,t;o=e,-1!==(t=a.Cat.findIndex(function(t){return t.categoryId===o.Id}))&&(a.Cat[t]=o)}).catch(function(t){throw console.error("Error deleting book:",t),t})}}angular.module("myApp").service("CatService",t),t.$inject=["$http","Endpoints"]})(),(()=>{function t(o){return{decode:function(){var t=o.localStorage.getItem("accessToken");if(!t)return null;try{return jwt_decode(t)}catch(t){return console.error("Invalid token:",t),null}}}}angular.module("myApp").factory("tokenService",t),t.$inject=["$window"]})(),(()=>{function t(t){this.title="Book Management System",this.subtitle="Easily manage your books, add new titles, track availability, and keep everything organized.",this.ctaText="Get Started",this.goToAddBook=function(){t.path("/addbook")}}angular.module("myApp").component("heroSection",{templateUrl:"app/component/heroSection/hero.html",controller:t,controllerAs:"hero"}),t.$inject=["$location"]})(),(()=>{function t(){}angular.module("myApp").component("appFooter",{templateUrl:"app/layouts/footer/footer.html",controller:t}),t.$inject=[]})(),(()=>{function t(t,o,e,n){var r=this;function a(){var t=e.decode();r.role=t?t["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]:null}r.isLoggedIn=function(){return t.isAuthenticated()},n.$on("loginSuccess",function(){a()}),n.$on("logoutSuccess",function(){r.role=null}),r.hasAdminAccess=function(){return r.isLoggedIn()&&("SPAdmin"===r.role||"Admin"===r.role)},r.hasUserAccess=function(){return r.isLoggedIn()&&"User"===r.role},r.logout=function(){t.logout(),o.path("/login")},a()}angular.module("myApp").controller("NavbarController",t),t.$inject=["authService","$location","tokenService","$rootScope"]})();