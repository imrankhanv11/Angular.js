function _typeof(o){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(o)}function ownKeys(t,o){var e,n=Object.keys(t);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(t),o&&(e=e.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,e)),n}function _objectSpread(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?ownKeys(Object(e),!0).forEach(function(o){_defineProperty(t,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):ownKeys(Object(e)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))})}return t}function _defineProperty(o,t,e){return(t=_toPropertyKey(t))in o?Object.defineProperty(o,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[t]=e,o}function _toPropertyKey(o){o=_toPrimitive(o,"string");return"symbol"==_typeof(o)?o:o+""}function _toPrimitive(o,t){if("object"!=_typeof(o)||!o)return o;var e=o[Symbol.toPrimitive];if(void 0===e)return("string"===t?String:Number)(o);e=e.call(o,t||"default");if("object"!=_typeof(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}angular.module("myApp",["ngRoute"]),angular.module("myApp").constant("Endpoints",{BASE_URL:"http://localhost:5007/api",BOOK:{GET_ALL:"/Books/GellAllBooks",CREATE:"/Books/AddBook",UPDATE:"/Books/UpdateBook",DELETE:"/Books/DeleteBook/"},USER:{LOGIN:"/Login/LoginUser",REGISTER:"/Login/RegisterUser",REFRESH:"/Login/RefreshToken"},CAT:{GET_ALL:"/Categorys/GetAllCategory"}}),(()=>{function o(t,r,c,i,a){var l=!1,u=[];return{request:function(o){var t;return o.url.endsWith(".html")||(t=r.localStorage.getItem("accessToken"))&&(o.headers.Authorization="Bearer ".concat(t)),o},responseError:function(e){var n,o;return 401!==e.status||l?401===e.status&&l?(o=t.defer(),u.push(o),o.promise.then(function(){var o=i.get("$http"),t=r.localStorage.getItem("accessToken");return e.config.headers.Authorization="Bearer ".concat(t),o(e.config)})):t.reject(e):(l=!0,n=i.get("$http"),(o=r.localStorage.getItem("refreshToken"))?n.post("".concat(a.BASE_URL).concat(a.USER.REFRESH),{refreshToken:o}).then(function(o){var o=o.data.accessToken,t=(r.localStorage.setItem("accessToken",o),l=!1,u.forEach(function(o){return o.resolve()}),u=[],e.config);return t.headers.Authorization="Bearer ".concat(o),n(t)}).catch(function(o){return l=!1,s(i,c),t.reject(o)}):(s(i,c),t.reject(e)))}};function s(o,t){o.get("authService").logout(),t.path("/login")}}angular.module("myApp").factory("authInterceptor",o),o.$inject=["$q","$window","$location","$injector","Endpoints"]})(),(()=>{function o(t,e,n){t.books=[],e.getBooks().then(function(o){t.books=o}),t.deleteBook=function(o){confirm("Do you Want to delete?")&&e.deleteBook(o).then(function(o){t.books=o})},t.editBook=function(o){n.path("addbook/"+o)}}angular.module("myApp").controller("AdminBookController",o),o.$inject=["$scope","bookService","$location"]})(),(()=>{function o(o){var t=this;t.Cat=[],o.getCat().then(function(o){t.Cat=o})}angular.module("myApp").component("appAdmincat",{templateUrl:"app/view/adminCatPage.html",controller:o,controllerAs:"$ctrl",bindings:{Binding:"="}}),o.$inject=["CatService"]})(),(()=>{function o(o,t,e,n){var r=this;r.book={title:"",author:"",price:"",stock:"",categoryId:""},r.isEditMode=!1,r.error="",r.category=[],o.get("http://localhost:5007/api/Categorys/GetAllCategory").then(function(o){r.category=o.data}),n.id&&(r.isEditMode=!0,o=t.getBookById(Number(n.id)),r.book.title=o.title,r.book.author=o.author,r.book.price=o.price,r.book.stock=o.stock,r.book.categoryId=o.categoryId),r.AddBook=function(){r.addBookForm&&r.addBookForm.$invalid?angular.forEach(r.addBookForm,function(o,t){"$"!==t[0]&&o.$setTouched&&o.$setTouched()}):r.isEditMode?t.updateBook(_objectSpread(_objectSpread({},r.book),{},{Id:Number(n.id)})).then(function(){e.path("/")}).catch(function(o){return console.log(o)}):t.addBook(r.book).then(function(){e.path("/")}).catch(function(o){return console.log(o)})}}angular.module("myApp").controller("BookAddController",o),o.$inject=["$http","bookService","$location","$routeParams"]})(),(()=>{function o(){}angular.module("myApp").controller("HomeController",o),o.$inject=[]})(),(()=>{function o(t,o){var e=this;e.user={userName:"",password:""},e.error="",e.login=function(){e.loginForm&&e.loginForm.$invalid?angular.forEach(e.loginForm,function(o,t){"$"!==t[0]&&o.$setTouched&&o.$setTouched()}):o.login(e.user).then(function(o){t.path("/"),e.error=""}).catch(function(o){console.error(o),e.error=o})}}angular.module("myApp").controller("LoginController",o),o.$inject=["$location","authService"]})(),(()=>{function o(t,o){t.books=[],o.getBooks().then(function(o){t.books=o})}angular.module("myApp").controller("UserBookController",o),o.$inject=["$scope","bookService"]})(),angular.module("myApp").config(["$routeProvider","$httpProvider",function(o,t){o.when("/",{templateUrl:"app/view/home.html",controller:"HomeController",controllerAs:"vm"}).when("/login",{templateUrl:"app/view/login.html",controller:"LoginController",controllerAs:"vm"}).when("/adminbook",{templateUrl:"app/view/adminBookPage.html",controller:"AdminBookController",controllerAs:"vm",resolve:{auth:["authGuard",function(o){o.adminOnly()}]}}).when("/admincat",{template:"<app-admincat></app-admincat>",resolve:{auth:["authGuard",function(o){o.adminOnly()}]}}).when("/addbook",{templateUrl:"app/view/bookAdd.html",controller:"BookAddController",controllerAs:"vm",resolve:{auth:["authGuard",function(o){o.adminOnly()}]}}).when("/addbook/:id",{templateUrl:"app/view/bookAdd.html",controller:"BookAddController",controllerAs:"vm",resolve:{auth:["authGuard",function(o){o.adminOnly()}]}}).when("/userbook",{templateUrl:"app/view/userBookPage.html",controller:"UserBookController",controllerAs:"vm",resolve:{auth:["authGuard",function(o){o.userOnly()}]}}).when("/unauthorized",{templateUrl:"app/view/unauthorized.html"}).otherwise({redirectTo:"/"}),t.interceptors.push("authInterceptor")}]),angular.module("myApp").factory("authGuard",["$q","$location","authService","tokenService",function(e,n,r,c){function o(o){var t;return r.isAuthenticated()?(t=(t=c.decode())?t["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]:null,!!o.includes(t)||(n.path("/unauthorized"),e.reject("Not authorized"))):(n.path("/login"),e.reject("Not authenticated"))}return{adminOnly:function(){return o(["Admin","SPAdmin"])},userOnly:function(){return o(["User"])},any:o}}]),angular.module("myApp").service("authService",["$http","$window","$rootScope","Endpoints",function(t,e,n,r){this.login=function(o){return t.post("".concat(r.BASE_URL).concat(r.USER.LOGIN),o).then(function(o){return o.data&&(e.localStorage.setItem("accessToken",o.data.accessToken),e.localStorage.setItem("refreshToken",o.data.refreshToken),n.$emit("loginSuccess")),o.data}).catch(function(o){throw o.data.message})},this.getToken=function(){return e.localStorage.getItem("accessToken")},this.isAuthenticated=function(){return!!this.getToken()},this.logout=function(){e.localStorage.removeItem("accessToken"),e.localStorage.removeItem("refreshToken"),n.$emit("logoutSuccess")}}]),(()=>{function o(n,r){var c={books:[]};this.state=c,this.getBookById=function(t){return c.books.find(function(o){return o.bookId===t})},this.getBooks=function(){return n.get("".concat(r.BASE_URL).concat(r.BOOK.GET_ALL)).then(function(o){return c.books=o.data,c.books}).catch(function(o){throw console.error("Error fetching books:",o),o})},this.updateBook=function(e){return n.put("".concat(r.BASE_URL).concat(r.BOOK.UPDATE),e).then(function(){var t,o;t=e,-1!==(o=c.books.findIndex(function(o){return o.bookId===t.Id}))&&(c.books[o]=t)}).catch(function(o){throw console.error("Error deleting book:",o),o})},this.deleteBook=function(t){return n.delete("".concat(r.BASE_URL).concat(r.BOOK.DELETE).concat(t)).then(function(){return c.books=c.books.filter(function(o){return o.bookId!==t}),c.books}).catch(function(o){throw console.error("Error deleting book:",o),o})},this.addBook=function(o){return n.post("".concat(r.BASE_URL).concat(r.BOOK.CREATE),o).then(function(){return c.books.push(o),c.books}).catch(function(o){throw console.error("Error at Adding",o),o})}}angular.module("myApp").service("bookService",o),o.$inject=["$http","Endpoints"]})(),(()=>{function o(o,t){var e={Cat:[]};this.state=e,this.getCat=function(){return o.get("".concat(t.BASE_URL).concat(t.CAT.GET_ALL)).then(function(o){return e.Cat=o.data,e.Cat}).catch(function(o){throw console.error("Error fetching Cat:",o),o})}}angular.module("myApp").service("CatService",o),o.$inject=["$http","Endpoints"]})(),(()=>{function o(t){return{decode:function(){var o=t.localStorage.getItem("accessToken");if(!o)return null;try{return jwt_decode(o)}catch(o){return console.error("Invalid token:",o),null}}}}angular.module("myApp").factory("tokenService",o),o.$inject=["$window"]})(),(()=>{function o(o){this.title="Book Management System",this.subtitle="Easily manage your books, add new titles, track availability, and keep everything organized.",this.ctaText="Get Started",this.goToAddBook=function(){o.path("/addbook")}}angular.module("myApp").component("heroSection",{templateUrl:"app/component/heroSection/hero.html",controller:o,controllerAs:"hero"}),o.$inject=["$location"]})(),(()=>{function o(){}angular.module("myApp").component("appFooter",{templateUrl:"app/layouts/footer/footer.html",controller:o}),o.$inject=[]})(),(()=>{function o(o,t,e,n){var r=this;function c(){var o=e.decode();r.role=o?o["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"]:null}r.isLoggedIn=function(){return o.isAuthenticated()},n.$on("loginSuccess",function(){c()}),n.$on("logoutSuccess",function(){r.role=null}),r.hasAdminAccess=function(){return r.isLoggedIn()&&("SPAdmin"===r.role||"Admin"===r.role)},r.hasUserAccess=function(){return r.isLoggedIn()&&"User"===r.role},r.logout=function(){o.logout(),t.path("/login")},c()}angular.module("myApp").controller("NavbarController",o),o.$inject=["authService","$location","tokenService","$rootScope"]})();